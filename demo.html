<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>d3.boxplot()</title>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="build/d3-boxplot.js"></script>
    <style>
        svg {
            outline: 1px solid #EEE;
            margin: 1em;
        }
    </style>
</head>
<body>
<h1>d3.boxplot() demo</h1>

<button onclick="update()">Update data</button>

<div>
    <h2>Horizontal box plots (with/without transition)</h2>
    <svg id="svg1"></svg>
    <svg id="svg2"></svg>
</div>
<div>
    <h2>Vertical box plots (with/without transition)</h2>
    <svg id="svg3"></svg>
    <svg id="svg4"></svg>
</div>

<script>
    function render(data, svg, w, h, transition) {
        var stats = data.map(function (d) {
            return d3.boxplotStats(d);
        });

        var vertical = w < h;
        var axis1 = d3.scaleLinear()
                .domain([-5, 5])
                .range([10, vertical ? h - 10 : w - 10]);
        var axis2 = d3.scaleBand()
                .domain(d3.range(stats.length))
                .range([10, vertical ? w - 10 : h - 10])
                .padding(0.15);
        var colors = d3.schemeCategory10;
        var boxplot = d3.boxplot()
                .scale(axis1)
                .bandwidth(axis2.bandwidth())
                .vertical(vertical)
                .jitter(true);

        var root = d3.select(svg)
                .attr('width', w)
                .attr('height', h);
        var plots = root.selectAll('g.plot').data(stats);
        plots.exit().remove();
        plots = plots.enter()
                .append('g')
                .attr('class', 'plot')
                .attr('transform', function (d, i) {
                    return vertical ?
                            'translate(' + axis2(i) + ', 0)' :
                            'translate(0, ' + axis2(i) + ')';
                })
                .merge(plots)
                .attr('color', function (d, i) {
                    return colors[i];
                });
        if (transition) plots = plots.transition();
        plots.call(boxplot);
    }

    function update() {
        var rand = d3.randomNormal();
        var data = [];
        for (let i = 0; i < 6; i++) {
            data.push(d3.range(Math.random() * 10 + 20 | 0).map(function () {
                return rand();
            }).sort(d3.ascending));
        }

        render(data, document.querySelector('#svg1'), 300, 200, true);
        render(data, document.querySelector('#svg2'), 300, 200, false);
        render(data, document.querySelector('#svg3'), 200, 300, true);
        render(data, document.querySelector('#svg4'), 200, 300, false);
    }

    update();
</script>
</body>
</html>
